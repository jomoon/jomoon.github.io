<!DOCTYPE html>
<html lang>
  <head><meta name="generator" content="Hexo 3.8.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="description" content="Guice Translation 02">








  <link rel="alternate" href="/default" title="Zain's Blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1">



<link rel="canonical" href="https://jomoon.github.io/guice-translation/Guice-start.html">


<meta name="description" content="translation from google/guice and google/guice/bindings 入门怎样通过使用Guice来依赖注入。 入门用依赖注入方法，在其构造器中接受依赖。为构造对象，你需要建造其依赖，但是为了生成这些依赖，你需要生成这些依赖所需依赖，依次类推。所以当你要建造一个对象，你需要建立对象图。 手动建立对象图属于劳动密集型，容易出错，且使得测试变得异常困难。然而，G">
<meta name="keywords" content="zain,翻译,Spring,guice">
<meta property="og:type" content="website">
<meta property="og:title" content="Guice Translation 02">
<meta property="og:url" content="https://jomoon.github.io/guice-translation/Guice-start.html">
<meta property="og:site_name" content="Zain&#39;s Blog">
<meta property="og:description" content="translation from google/guice and google/guice/bindings 入门怎样通过使用Guice来依赖注入。 入门用依赖注入方法，在其构造器中接受依赖。为构造对象，你需要建造其依赖，但是为了生成这些依赖，你需要生成这些依赖所需依赖，依次类推。所以当你要建造一个对象，你需要建立对象图。 手动建立对象图属于劳动密集型，容易出错，且使得测试变得异常困难。然而，G">
<meta property="og:locale" content="chinese">
<meta property="og:updated_time" content="2019-07-30T11:29:33.790Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Guice Translation 02">
<meta name="twitter:description" content="translation from google/guice and google/guice/bindings 入门怎样通过使用Guice来依赖注入。 入门用依赖注入方法，在其构造器中接受依赖。为构造对象，你需要建造其依赖，但是为了生成这些依赖，你需要生成这些依赖所需依赖，依次类推。所以当你要建造一个对象，你需要建立对象图。 手动建立对象图属于劳动密集型，容易出错，且使得测试变得异常困难。然而，G">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1">
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  



    <title> Guice Translation 02 - Zain's Blog </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">Zain's Blog</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        <article class="post">
            <header class="post-header">
                <h1 class="post-title">
                    Guice Translation 02
                </h1>
            </header>
            <div class="post-content">
                <p>translation from <a href="https://github.com/google/guice/wiki/GettingStarted" target="_blank" rel="noopener">google/guice</a> and <a href="https://github.com/google/guice/wiki/Bindings" target="_blank" rel="noopener">google/guice/bindings</a></p>
<h2 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h2><p>怎样通过使用<code>Guice</code>来依赖注入。</p>
<h3 id="入门-1"><a href="#入门-1" class="headerlink" title="入门"></a>入门</h3><p>用依赖注入方法，在其构造器中接受依赖。为构造对象，你需要建造其依赖，但是为了生成这些依赖，你需要生成这些依赖所需依赖，依次类推。所以当你要建造一个对象，你需要建立对象图。</p>
<p>手动建立对象图属于劳动密集型，容易出错，且使得测试变得异常困难。然而，<code>Guice</code>可以替代你建立对象图。但首先，<code>Guice</code>需要你去配置你想要的图。</p>
<p>举例来说，我们从<code>BillingService</code>类说起，他构造器接受的依赖接口是<code>CreditCardProcessor</code> 和 <code>TransactionLog</code>。为明确地指明 <code>BillingService</code> 被<code>Guice</code> 所调用的构造器，我们给其构造器增加<code>@Inject</code> 注解。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BillingService</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> CreditCardProcessor processor;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> TransactionLog transactionLog;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Inject</span></span><br><span class="line">  BillingService(CreditCardProcessor processor, </span><br><span class="line">      TransactionLog transactionLog) &#123;</span><br><span class="line">    <span class="keyword">this</span>.processor = processor;</span><br><span class="line">    <span class="keyword">this</span>.transactionLog = transactionLog;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Receipt <span class="title">chargeOrder</span><span class="params">(PizzaOrder order, CreditCard creditCard)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们想使用<code>PaypalCreditCardProcessor</code> 和 <code>DatabaseTransactionLog</code> 建造<code>BillingService</code>。<code>Guice</code> 使用绑定其类型和对应的实现类的Map。一个<code>Module</code>是一系列特定使用流畅的，英文式方法调用来组成Map。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BillingModule</span> <span class="keyword">extends</span> <span class="title">AbstractModule</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span> </span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">     <span class="comment">/*</span></span><br><span class="line"><span class="comment">      * This tells Guice that whenever it sees a dependency on a TransactionLog,</span></span><br><span class="line"><span class="comment">      * it should satisfy the dependency using a DatabaseTransactionLog.</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">    bind(TransactionLog.class).to(DatabaseTransactionLog.class);</span><br><span class="line"></span><br><span class="line">     <span class="comment">/*</span></span><br><span class="line"><span class="comment">      * Similarly, this binding tells Guice that when CreditCardProcessor is used in</span></span><br><span class="line"><span class="comment">      * a dependency, that should be satisfied with a PaypalCreditCardProcessor.</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">    bind(CreditCardProcessor.class).to(PaypalCreditCardProcessor.class);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>模块是一个Injector，那是一个Guice的对象图建造者。首先我们创建Injector，然后我们使用他来建造<code>BillingSerice</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">   <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * Guice.createInjector() takes your Modules, and returns a new Injector</span></span><br><span class="line"><span class="comment">    * instance. Most applications will call this method exactly once, in their</span></span><br><span class="line"><span class="comment">    * main() method.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   Injector injector = Guice.createInjector(<span class="keyword">new</span> BillingModule());</span><br><span class="line"></span><br><span class="line">   <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * Now that we've got the injector, we can build objects.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   BillingService billingService = injector.getInstance(BillingService.class);</span><br><span class="line">   ...</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>通过建造<code>billingService</code>，我们已经使用Guice构造了一个小的对象图。这个图包含billingService 和 他的依赖 信用卡处理器 和 交易记录。</p>
<h2 id="绑定"><a href="#绑定" class="headerlink" title="绑定"></a>绑定</h2><p>在<code>Guice</code>中的bindings总览。</p>
<h3 id="Bindings"><a href="#Bindings" class="headerlink" title="Bindings"></a>Bindings</h3><p>注入器(Injector)的工作是装配对象图。你需要一个给定类型的实例，他搞清楚你想要建造的是什么，解决依赖注入，并且将所有编制在一起。为弄清楚依赖是如何解析的，需要你给注射器做配置。</p>
<h3 id="创建Bindings"><a href="#创建Bindings" class="headerlink" title="创建Bindings"></a>创建Bindings</h3><p>为了创建Bindings，继承<code>AbstractModule</code>并且覆写他的<code>configure</code>方法。在方法体中，调用<code>bind()</code>来指定每个绑定关系。这些方法都有类型检查如果你写了错误类型，那么编译器就会报错。一旦你创建了你自己的modules(模组)，通过<code>Guice.createInjector()</code>传递参数来创建一个injector(注入器)。</p>
<p>使用modules(模组)来创建关联绑定关系，实例绑定，<code>@Provides</code>方法，提供者绑定(provider bindings),构造器绑定和非指向性的绑定。</p>
<h3 id="更多绑定"><a href="#更多绑定" class="headerlink" title="更多绑定"></a>更多绑定</h3><p>除了明确包含在你创建的injector中绑定关系。当依赖被需要但却不存在时企图去创建一个实时绑定。注入器也包含其他绑定关系的提供者。</p>

            </div>
        </article>
    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2014 -
    
    2019
    <span class="footer-author">Huangjiangjun.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
